<div class="row justify-content-center">
  <h1>{{ site.data.projects.heading.[page.lang] | escape }}</h1>
</div>

{% assign projects = site.data.projects.projects | sort:"date" %}
{% assign previous_year = "" %}
{% for p in projects reversed %}
{% assign date = p.date | split: '-' %}
{% if date[0] != previous_year %}
  <div class="row">
    <div class="col-10 col-sm-12 offset-1 offset-sm-0">
      <h2>{{ date[0] }}</h2>
    </div>
  </div>
  {% assign previous_year = date[0] %}
{% endif %}
  <div class="row project">
    <div class="col-sm-3 offset-sm-0 col-8 offset-2">
      {% assign thumbnail_src = p.thumbnail %}
      {% assign thumbnail_alt = p.title %}
      {% assign thumbnail_flickr = p.flickr %}
      {% if p.thumbnail %}{% include thumbnail.html %}{% endif %}
    </div>
    <div class="col-sm-3 offset-sm-0 col-10 offset-1">
      <h4>{{ p.title | escape }}</h4>
      {% if p.role or p.type %}<p>
        {% if p.role %}{{ site.data.projects.role[page.lang] }}: {{ p.role }}{% endif %}
        {% if p.role and p.type %}<br />{% endif %}
        {% if p.type %}{{ site.data.projects.type[page.lang] }}: {{ p.type }}{% endif %}
      </p>{% endif %}
    </div>
    <div class="col-sm-6 offset-sm-0 col-10 offset-1">
      <p>
        {{ p.caption.[page.lang] }}
      </p>
      <p>
        {% for download in p.downloads %}
          <a {% if download.video %}class="video-{{ download.video }}" {% endif %}href="{{ download.href }}">{{ download.desc }}</a>
          {% if download != p.downloads.last %}, {% endif %}
        {% endfor %}
      </p>
    </div>
  </div>
{% endfor %}
